<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Official Verification Letter - JP Group</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/Verify.css">

    <script src="lib/qrcode.min.js"></script>
    <script src="lib/jspdf.umd.min.js"></script>
    <script src="lib/html2canvas.min.js"></script>

    <style>
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin Bar ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö */
        .no-print.admin-panel {
            background: #2d3436;
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .panel-content {
            max-width: 800px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        .btn-back {
            background: transparent;
            color: #dfe6e9;
            border: 1px solid #636e72;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Sarabun', sans-serif;
        }
        .btn-action {
            background: #0984e3;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            margin-left: 10px;
            font-family: 'Sarabun', sans-serif;
        }
        .btn-action.pdf { background: #d63031; }
        .btn-action:hover { opacity: 0.9; transform: translateY(-1px); }

        /* ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå (Print Settings) */
        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; margin: 0; }
            #document-wrapper { padding: 0; }
            .page.shadow { box-shadow: none; border: none; margin: 0; }
        }
    </style>
</head>
<body>

    <nav class="no-print admin-panel">
        <div class="panel-content">
            <button onclick="location.href='index.html'" class="btn-back">üè† Home</button>
            <div class="actions">
                <button onclick="window.print()" class="btn-action">üñ®Ô∏è Print Document</button>
                <button id="pdf-btn" onclick="exportToPDF()" class="btn-action pdf">üìÑ Download PDF</button>
            </div>
        </div>
    </nav>

    <div id="document-wrapper">
        <div id="page-container">
            <div class="page shadow">
                
                <div class="letterhead">
                    <div class="company-logo">
                        <img src="assets/Logo.jpg" alt="JP Group Logo" onerror="this.src='https://via.placeholder.com/150x50?text=JP+GROUP'">
                    </div>
                    <div class="company-info">
                        <h2>JP GROUP MANAGEMENT CO., LTD.</h2>
                        <p>123 Ratchadaphisek Rd, Din Daeng, Bangkok 10400, Thailand</p>
                        <p>Tel: +66 2 888 8888 | Email: compliance@jpgroup.com</p>
                        <p>Registration No: 01055XXXXXXXX</p>
                    </div>
                </div>

                <div class="letter-content">
                    <div class="date-row">
                        Date: <span id="current-date">December 17, 2025</span>
                    </div>

                    <div class="subject-title">TO WHOM IT MAY CONCERN</div>

                    <div class="subject-line">
                        <strong>Subject: Financial Guarantee and Sponsorship Certification</strong>
                    </div>

                    <div class="letter-body">
                        <p>This letter serves as an official confirmation that <strong>Ms. Kritsana Charoensuk</strong>, holder of Thai Passport Number <strong>AA1234567</strong>, is a high-valued client of <strong>JP Group Management Co., Ltd.</strong></p>
                        
                        <p>We hereby certify that the aforementioned individual maintains sufficient financial standing for the purpose of her international travel. Our records confirm a total verifiable liquidity of <strong>THB 1,250,000.00 (One Million Two Hundred Fifty Thousand Baht Only)</strong>.</p>
                        
                        <p>This certificate is issued at the specific request of our client to support her <strong>Visa Application</strong>. JP Group Management guarantees the authenticity of this financial statement as of the date of issuance.</p>
                        
                        <p>Should you require further verification or have any inquiries regarding this document, please contact our Compliance Department at +66 2 888 8888 or scan the secure QR code below.</p>
                    </div>

                    <div class="signature-section">
                        <p>Yours Faithfully,</p>
                        <div class="sign-space">
                            <img src="assets/Seal.png" class="company-seal" alt="Company Seal" id="seal-img" 
                                 onerror="this.style.display='none'">
                        </div>
                        <div class="sign-name">
                            <p><strong>(Mr. Jakkarin P.)</strong></p>
                            <p>Managing Director</p>
                            <p>JP Group Management Co., Ltd.</p>
                        </div>
                    </div>

                    <div class="footer-verify">
                        <div id="verify-qr" class="qr-container" data-ref="REF-JP20251217-01"></div>
                        <div class="verify-text">
                            <p><strong>Verification Code:</strong> JP20251217-01</p>
                            <p>This is a secure document. Scan the QR Code to verify the authenticity of this letter via our official portal.</p>
                        </div>
                    </div>
                </div>
                
                <div class="page-footer-line"></div>
            </div>
        </div>
    </div>

    <script src="js/Verify.js"></script>

    <script>
        /**
         * ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡∏ó‡∏µ‡πà‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏ö‡∏ô Vercel
         */
        function generateQRCode() {
            const qrDiv = document.getElementById('verify-qr');
            if (qrDiv && typeof QRCode !== 'undefined') {
                const refCode = qrDiv.dataset.ref || 'JP-' + Date.now();
                
                // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç URL ‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤ Verify ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                const verifyUrl = `https://document-portal-lime.vercel.app/JPverify.html?id=${refCode}&type=legal`;
                
                new QRCode(qrDiv, {
                    text: verifyUrl,
                    width: 90,
                    height: 90,
                    colorDark : "#2d3436",
                    colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.H
                });
            }
        }

        /**
         * ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF ‡∏Ç‡∏ô‡∏≤‡∏î A4 ‡∏ó‡∏µ‡πà‡∏Ñ‡∏°‡∏ä‡∏±‡∏î (Scale 3)
         */
        async function exportToPDF() {
            const btn = document.getElementById('pdf-btn');
            const originalText = btn.innerText;
            btn.innerText = "‚åõ Generating...";
            btn.disabled = true;

            try {
                const { jsPDF } = window.jspdf;
                const element = document.querySelector('.page');
                
                const canvas = await html2canvas(element, {
                    scale: 3, // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏π‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏Å
                    useCORS: true,
                    backgroundColor: "#ffffff"
                });

                const imgData = canvas.toDataURL('image/jpeg', 1.0);
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤ A4 ‡∏û‡∏≠‡∏î‡∏µ (210mm x 297mm)
                pdf.addImage(imgData, 'JPEG', 0, 0, 210, 297);
                pdf.save(`JP_Financial_Verify_${new Date().getTime()}.pdf`);
            } catch (error) {
                console.error("PDF Export Error:", error);
                alert("Error generating PDF. Please try again.");
            } finally {
                btn.innerText = originalText;
                btn.disabled = false;
            }
        }

        // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©
        window.addEventListener('load', () => {
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏ö‡∏ö US Format
            const dateSpan = document.getElementById('current-date');
            if (dateSpan) {
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                dateSpan.innerText = new Date().toLocaleDateString('en-US', options);
            }
            
            // ‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥ QR
            setTimeout(generateQRCode, 500);
        });
    </script>
</body>
</html>
